-- Service: Go Home At Six
-- Last Modified: 2019.05.03
-- Version: 1.0.0

-- {ServiceName} : {ServiceName}

CREATE DATABASE {ServiceName};
USE {ServiceName};

-- 출퇴근 테이블
CREATE TABLE `{ServiceName}`.`cummutes` (
  `id`                   INT NOT NULL AUTO_INCREMENT, -- 고유 ID
  `own_user_id`          INT NOT NULL,                -- 소유유저 ID
  `cummute_company_name` VARCHAR(64) NOT NULL,        -- 출퇴근 회사 이름
  `check_in_time`        BIGINT NOT NULL,             -- 출근시간
  `check_out_time`       BIGINT,                      -- 퇴근시간
  `memo`                 VARCHAR(256),                -- 메모

  PRIMARY KEY (`id`),
  CONSTRAINT `cummutes_fk_own_user_id`
    FOREIGN KEY (`own_user_id`) REFERENCES `{ServiceName}`.`users` (`id`)
    ON DELETE NO ACTION
    ON UPDATE CASCADE
);

-- 회원 테이블
CREATE TABLE `{ServiceName}`.`users` (
  `id`              INT NOT NULL AUTO_INCREMENT, -- 고유 ID
  `email`           VARCHAR(128) NOT NULL,       -- 고유 메일주소 (RFC 2822에 따르면 320자까지 가능하지만 utf8mb4체어셋 한계로 크기 제한)
  `name`            VARCHAR(64) NOT NULL,        -- 이름
  `join_time`       BIGINT NOT NULL,             -- 가입일자
  `last_login_time` BIGINT,                      -- 마지막 로그인 일자
  `accessible_time` BIGINT,                      -- 서비스 접근가능 시점의 시간

  PRIMARY KEY (`id`),
  UNIQUE INDEX `users_uk_idx_email` (`email` ASC)
);